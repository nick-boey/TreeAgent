@using Microsoft.AspNetCore.Components.Web

<div class="chat-input-area">
    <textarea @bind="Value"
              @bind:event="oninput"
              @onkeydown="HandleKeyDown"
              placeholder="@Placeholder"
              rows="3"
              disabled="@Disabled">
    </textarea>
    <button class="btn btn-primary chat-send-button"
            @onclick="HandleSend"
            disabled="@(string.IsNullOrWhiteSpace(Value) || Disabled)">
        Send
    </button>
</div>

@code {
    [Parameter]
    public string Value { get; set; } = string.Empty;

    [Parameter]
    public EventCallback<string> ValueChanged { get; set; }

    [Parameter]
    public string Placeholder { get; set; } = "Type a message...";

    [Parameter]
    public bool Disabled { get; set; }

    [Parameter]
    public EventCallback<string> OnSend { get; set; }

    private async Task HandleKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Enter" && !e.ShiftKey)
        {
            await HandleSend();
        }
    }

    private async Task HandleSend()
    {
        if (string.IsNullOrWhiteSpace(Value) || Disabled)
            return;

        var message = Value;
        Value = string.Empty;
        await ValueChanged.InvokeAsync(Value);
        await OnSend.InvokeAsync(message);
    }
}
