@using Homespun.Features.Roadmap
<div class="future-change-item @(IsSelected ? "selected" : "")"
     style="padding-left: @(Depth * 16)px"
     @onclick="HandleClick">
    <div class="item-type-indicator @GetTypeClass()"></div>
    <div class="item-content">
        <div class="item-title">@Change.Title</div>
        <div class="item-meta">
            <span class="item-type-badge @GetTypeClass()">@Change.Type</span>
            @if (Change.Priority.HasValue)
            {
                <span class="item-priority @GetPriorityClass()">@Change.Priority</span>
            }
            @if (Change.EstimatedComplexity.HasValue)
            {
                <span class="item-complexity">@Change.EstimatedComplexity</span>
            }
        </div>
    </div>
    <div class="item-time">
        t=@Time
    </div>
</div>

@code {
    [Parameter]
    public RoadmapChange Change { get; set; } = null!;

    [Parameter]
    public int Depth { get; set; }

    [Parameter]
    public int Time { get; set; }

    [Parameter]
    public bool IsSelected { get; set; }

    [Parameter]
    public EventCallback OnSelected { get; set; }

    private async Task HandleClick()
    {
        await OnSelected.InvokeAsync();
    }

    private string GetTypeClass()
    {
        return Change.Type switch
        {
            ChangeType.Feature => "type-feature",
            ChangeType.Bug => "type-bug",
            ChangeType.Refactor => "type-refactor",
            ChangeType.Docs => "type-docs",
            ChangeType.Test => "type-test",
            ChangeType.Chore => "type-chore",
            _ => ""
        };
    }

    private string GetPriorityClass()
    {
        return Change.Priority switch
        {
            Priority.High => "priority-high",
            Priority.Medium => "priority-medium",
            Priority.Low => "priority-low",
            _ => ""
        };
    }
}
