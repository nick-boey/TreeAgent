@page "/projects/create"
@using Homespun.Features.Projects
@inject ProjectService ProjectService
@inject NavigationManager Navigation
@rendermode InteractiveServer

<PageTitle>New Project</PageTitle>

<h1>New Project</h1>

<form @onsubmit="HandleSubmit">
    <div class="mb-3">
        <label for="name" class="form-label">Name</label>
        <input type="text" class="form-control" id="name" @bind="_name" required />
    </div>

    <div class="mb-3">
        <label for="localPath" class="form-label">Local Path</label>
        <input type="text" class="form-control" id="localPath" @bind="_localPath" required placeholder="/path/to/repository" />
    </div>

    <div class="mb-3">
        <label for="gitHubOwner" class="form-label">GitHub Owner (optional)</label>
        <input type="text" class="form-control" id="gitHubOwner" @bind="_gitHubOwner" placeholder="owner" />
    </div>

    <div class="mb-3">
        <label for="gitHubRepo" class="form-label">GitHub Repository (optional)</label>
        <input type="text" class="form-control" id="gitHubRepo" @bind="_gitHubRepo" placeholder="repo" />
    </div>

    <div class="mb-3">
        <label for="defaultBranch" class="form-label">Default Branch</label>
        <input type="text" class="form-control" id="defaultBranch" @bind="_defaultBranch" />
    </div>

    <button type="submit" class="btn btn-primary">Create</button>
    <a href="projects" class="btn btn-secondary">Cancel</a>
</form>

@code {
    private string _name = "";
    private string _localPath = "";
    private string? _gitHubOwner;
    private string? _gitHubRepo;
    private string _defaultBranch = "main";

    private async Task HandleSubmit()
    {
        await ProjectService.CreateAsync(_name, _localPath, _gitHubOwner, _gitHubRepo, _defaultBranch);
        Navigation.NavigateTo("projects");
    }
}
